function initialize(){var e=!0,t=io.connect("http://localhost:8000");t.on("load",function(t){var a=[],r=[],o=[],i=[],c=[],s=[];c=t.messages.reverse().slice(0,100).map(function(e){return{title:e.title,description:e.description,latitude:e.latitude,longitude:e.longitude,createddate:e.createddate,category:e.category,subcategory:e.subcategory,exactlocation:e.exactlocation}}),s=deleteCopy(c),s.forEach(function(e){switch(Number(e.category)){case 0:a.push(e);break;case 1:r.push(e);break;case 2:o.push(e);break;case 3:i.push(e)}});var l=document.querySelector(".switch"),d=document.getElementById("ul");l.addEventListener("change",function(e){switch(d.textContent="",e.target.options.selectedIndex){case 0:n.createMarkers(a);break;case 1:n.createMarkers(r);break;case 2:n.createMarkers(o);break;case 3:n.createMarkers(i);break;default:n.createMarkers(s)}}),e===!0&&(e=!1,n.createMarkers(s))});var a,n={markers:[],createMarkers:function(e){n.markers.forEach(function(e){e.setMap(null)}),n.markers=[];var t;e.forEach(function(e,r){var o=createInfoString(e),i=new google.maps.LatLng(e.latitude,e.longitude),c=new google.maps.Marker({position:i,map:a,title:e.title,infoWindow:new google.maps.InfoWindow({content:o})});n.markers.push(c),createList(e,r),google.maps.event.addListener(c,"click",function(){void 0!==t&&t.infoWindow.close(),a.setZoom(10),a.setCenter(i),c.infoWindow.open(a,c),t=c})});var r=document.getElementById("ul");google.maps.event.addDomListener(r,"click",function(e){return e.preventDefault(),"A"!==e.target.nodeName?!1:void google.maps.event.trigger(n.markers[e.target.id],"click")})}},r=new google.maps.LatLng(62.56282,13.35524),o={center:r,zoom:5,mapTypeId:google.maps.MapTypeId.ROADMAP};a=new google.maps.Map(document.getElementById("map-canvas"),o)}function createList(e,t){var a=document.getElementById("ul"),n=document.createElement("li");n.setAttribute("class","li");var r=document.createElement("a");return r.title=e.exactlocation,r.href="",r.setAttribute("class","a"),n.appendChild(r),a.appendChild(n),r.setAttribute("id",t),r.textContent=r.textContent+e.title,n}function deleteCopy(e){var t={},a=e.filter(function(e){return t.hasOwnProperty(e.title)?!1:t[e.title]=!0});return a}google.maps.event.addDomListener(window,"load",initialize);